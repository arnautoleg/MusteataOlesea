---
title: "Bivariate_hypothesis_testing"
author: "Oleg Arnaut"
date: "2023-11-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
library(BSDA)


```


#–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

## Normal Distribution

```{r}

# Load necessary libraries
library(ggplot2)

# Create a sequence of x values
x_values <- seq(-3, 3, by = 0.01)

# Calculate the PDF values for the standard normal distribution
pdf_normal <- dnorm(x_values, mean = 0, sd = 1)

# Create a data frame for plotting
pdf_data <- data.frame(x = x_values, Probability = pdf_normal)

# Create a PDF plot to visualize the standard normal distribution
ggplot(pdf_data, aes(x = x, y = Probability)) +
  geom_line(size = 1, color = "blue") +
  labs(title = "PDF of Standard Normal Distribution", x = "x", y = "Probability Density") +
  theme_minimal()



```


## Bernoulli Distribution
  
  
```{r}
 
# Load necessary libraries
library(ggplot2)

# Define the probability of success for the Bernoulli distribution
p <- 0.3

# Create a sequence of possible values (0 and 1)
x_values <- c(0, 1)

# Calculate the PMF values for the Bernoulli distribution
pmf_bernoulli <- c(1 - p, p)

# Create a data frame for plotting
pmf_data <- data.frame(x = x_values, Probability = pmf_bernoulli)

# Create a PMF plot to visualize the Bernoulli distribution
ggplot(pmf_data, aes(x = factor(x), y = Probability)) +
  geom_bar(stat = "identity", fill = "blue", color = "black", width = 0.5) +
  labs(title = "PMF of Bernoulli Distribution", x = "Outcome", y = "Probability") +
  theme_minimal()


```



## Binomial Distribution

```{r}

# Load necessary libraries
library(ggplot2)

# Define the parameters of the binomial distribution
n <- 10  # Number of trials
p <- 0.2  # Probability of success in each trial

# Create a sequence of possible values for the number of successes
x_values <- 0:n

# Calculate the PMF values for the binomial distribution
pmf_binomial <- dbinom(x_values, size = n, prob = p)

# Create a data frame for plotting
pmf_data <- data.frame(x = x_values, Probability = pmf_binomial)

# Create a PMF plot to visualize the binomial distribution
ggplot(pmf_data, aes(x = factor(x), y = Probability)) +
  geom_bar(stat = "identity", fill = "blue", color = "black", width = 0.5) +
  labs(title = "PMF of Binomial Distribution", x = "Number of Successes", y = "Probability") +
  theme_minimal()


```




## Poisson Distribution

```{r}


# Load necessary libraries
library(ggplot2)

# Define the average rate of events for the Poisson distribution
lambda <- 10  # Average rate of events

# Create a sequence of possible values for the number of events
x_values <- 0:20

# Calculate the PMF values for the Poisson distribution
pmf_poisson <- dpois(x_values, lambda)

# Create a data frame for plotting
pmf_data <- data.frame(x = x_values, Probability = pmf_poisson)

# Create a PMF plot to visualize the Poisson distribution
ggplot(pmf_data, aes(x = factor(x), y = Probability)) +
  geom_bar(stat = "identity", fill = "blue", color = "black", width = 0.5) +
  labs(title = "PMF of Poisson Distribution", x = "Number of Events", y = "Probability") +
  theme_minimal()



```



## Chi-Squared Distribution

```{r}


# Load necessary libraries
library(ggplot2)

# Define the degrees of freedom for the chi-squared distribution
df <- 15  # Degrees of freedom

# Create a sequence of x values
x_values <- seq(0, 100, by = 0.1)  # Adjust the range and step size as needed

# Calculate the PDF values for the chi-squared distribution
pdf_chi_squared <- dchisq(x_values, df)

# Create a data frame for plotting
pdf_data <- data.frame(x = x_values, Probability = pdf_chi_squared)

# Create a PDF plot to visualize the chi-squared distribution
ggplot(pdf_data, aes(x = x, y = Probability)) +
  geom_line(size = 1, color = "blue") +
  labs(title = "PDF of Chi-Squared Distribution", x = "x", y = "Probability Density") +
  theme_minimal()



```



## Student's Distribution

```{r}


# Load necessary libraries
library(ggplot2)

# Define the degrees of freedom for the t-distribution
df <- 5  # Degrees of freedom

# Create a sequence of x values
x_values <- seq(-3, 3, by = 0.1)  # Adjust the range and step size as needed

# Calculate the PDF values for the t-distribution
pdf_t <- dt(x_values, df)

# Create a data frame for plotting
pdf_data <- data.frame(x = x_values, Probability = pdf_t)

# Create a PDF plot to visualize the t-distribution
ggplot(pdf_data, aes(x = x, y = Probability)) +
  geom_line(size = 1, color = "blue") +
  labs(title = "PDF of Student's t-Distribution", x = "x", y = "Probability Density") +
  theme_minimal()



```


## Fisher-Snedecor Distribution

```{r}

# Load necessary libraries
library(ggplot2)

# Define the degrees of freedom parameters for the F-distribution
df1 <- 100  # Degrees of freedom numerator
df2 <- 100  # Degrees of freedom denominator

# Create a sequence of x values
x_values <- seq(0.01, 5, by = 0.01)  # Adjust the range and step size as needed

# Calculate the PDF values for the F-distribution
pdf_fisher <- df(x_values, df1, df2)

# Create a data frame for plotting
pdf_data <- data.frame(x = x_values, Probability = pdf_fisher)

# Create a PDF plot to visualize the F-distribution
ggplot(pdf_data, aes(x = x, y = Probability)) +
  geom_line(size = 1, color = "blue") +
  labs(title = "PDF of Fisher-Snedecor (F) Distribution", x = "x", y = "Probability Density") +
  theme_minimal()


```



# –ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏

## –ì–∏–ø–æ—Ç–µ–∑—ã –æ —Å—Ä–µ–¥–Ω–∏—Ö

### Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ

```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞ ggplot2
library(ggplot2)

#?quantile

observed=-4

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π x
x_values <- seq(-4, 4, by = 0.01)

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –ü–ª–æ—Ç–Ω–æ—Å—Ç–∏ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (PDF) –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
pdf_normal <- dnorm(x_values, mean = 0, sd = 1)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
quantiles <- c(0.05, 1)

quantile_values <- qnorm(quantiles, mean = 0, sd = 1)

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
pdf_data <- data.frame(x = x_values, Probability = pdf_normal)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pdf_data, aes(x = x)) +
  geom_line(aes(y = Probability), linewidth = 1, color = "black", linetype = "solid") +
  geom_vline(xintercept = quantile_values, linewidth = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = observed, linewidth = 2, linetype = "dashed", color = "red") +
  annotate("text", x = quantile_values[1]-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[1], quantile_values[1]), hjust = 0, angle = 90) +
  annotate("text", x = quantile_values[2]-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[2], quantile_values[2]), hjust = 0, angle = 90) +
  annotate("text", x = observed-0.15, y = 0.2, label = 'observed', hjust = 0, angle = 90)+
  labs(title = "PDF —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏")
  


```

### t-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ

```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞ ggplot2
library(ggplot2)

#?quantile

observed=-4

# Define the degrees of freedom for the t-distribution
df <- 99  # Degrees of freedom

# Create a sequence of x values
x_values <- seq(-4, 4, by = 0.01)  # Adjust the range and step size as needed

# Calculate the PDF values for the t-distribution
pdf_t <- dt(x_values, df)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
quantiles <- c(0.05, 1)

#quantile_values <- qnorm(quantiles, mean = 0, sd = 1)

t_critical_low <- qt(quantiles[1], df = df)
t_critical_up <-  qt(quantiles[2], df = df)

# Create a data frame for plotting
pdf_data <- data.frame(x = x_values, Probability = pdf_t)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pdf_data, aes(x = x)) +
  geom_line(aes(y = Probability), linewidth = 1, color = "black", linetype = "solid") +
  geom_vline(xintercept = t_critical_low, linewidth = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = t_critical_up, linewidth = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = observed, linewidth = 2, linetype = "dashed", color = "red") +
  annotate("text", x = t_critical_low-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[1], t_critical_low), hjust = 0, angle = 90) +
  annotate("text", x = t_critical_up-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[2], t_critical_up), hjust = 0, angle = 90) +
  annotate("text", x = observed-0.15, y = 0.2, label = 'observed', hjust = 0, angle = 90)+
  annotate("text", x = 2.5, y = 0.6, label = sprintf("df(%.0f)", df), hjust = 0)+
  labs(title = "PDF —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –°—Ç—å—é–¥–µ–Ω—Ç–∞", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏")


```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ R

```{r}

library(BSDA)

# –¢–µ—Å—Ç Z –¥–ª—è –æ–¥–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏

# –î–∞–Ω–Ω—ã–µ (–∑–∞–º–µ–Ω–∏—Ç–µ –∏—Ö —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏)
sample_data_z <- c(23, 25, 27, 21, 24, 26, 22, 28, 25, 27)

# –ì–∏–ø–æ—Ç–µ–∑–∞ –æ —Å—Ä–µ–¥–Ω–µ–º –∑–Ω–∞—á–µ–Ω–∏–∏ –≤ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏
population_mean_z <- 25

# –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç Z
z_test_result <- z.test(sample_data_z, mu = population_mean_z, sigma.x =sd(sample_data_z))

# –í—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
print("–¢–µ—Å—Ç Z –¥–ª—è –æ–¥–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏:")
print(z_test_result)


# –¢–µ—Å—Ç t –¥–ª—è –æ–¥–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏

# –î–∞–Ω–Ω—ã–µ (–∑–∞–º–µ–Ω–∏—Ç–µ –∏—Ö —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏)
sample_data_t <- c(23, 25, 27, 21, 24, 26, 22, 28, 25, 27)

# –ì–∏–ø–æ—Ç–µ–∑–∞ –æ —Å—Ä–µ–¥–Ω–µ–º –∑–Ω–∞—á–µ–Ω–∏–∏ –≤ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏
population_mean_t <- 25

# –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç t
t_test_result <- t.test(sample_data_t, mu = population_mean_t)

# –í—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
print("\n–¢–µ—Å—Ç t –¥–ª—è –æ–¥–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏:")
print(t_test_result)

?t.test


```




## –ì–∏–ø–æ—Ç–µ–∑—ã –æ —Ä–∞–∑–Ω–∏—Ü–µ —Å—Ä–µ–¥–Ω–∏—Ö

### Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥–Ω–∏—Ö. –í—ã–±–æ—Ä–∫–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ

```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞ ggplot2
library(ggplot2)

#?quantile

observed=-4

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π x
x_values <- seq(-4, 4, by = 0.01)

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –ü–ª–æ—Ç–Ω–æ—Å—Ç–∏ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (PDF) –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
pdf_normal <- dnorm(x_values, mean = 0, sd = 1)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
quantiles <- c(0.05, 1)

quantile_values <- qnorm(quantiles, mean = 0, sd = 1)

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
pdf_data <- data.frame(x = x_values, Probability = pdf_normal)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pdf_data, aes(x = x)) +
  geom_line(aes(y = Probability), linewidth = 1, color = "black", linetype = "solid") +
  geom_vline(xintercept = quantile_values, linewidth = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = observed, linewidth = 2, linetype = "dashed", color = "red") +
  annotate("text", x = quantile_values[1]-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[1], quantile_values[1]), hjust = 0, angle = 90) +
  annotate("text", x = quantile_values[2]-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[2], quantile_values[2]), hjust = 0, angle = 90) +
  annotate("text", x = observed-0.15, y = 0.2, label = 'observed', hjust = 0, angle = 90)+
  labs(title = "PDF —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏")

```



### t-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥–Ω–∏—Ö. –í—ã–±–æ—Ä–∫–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ

```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞ ggplot2
library(ggplot2)

#?quantile

observed=-4

# Define the degrees of freedom for the t-distribution
df <- 99  # Degrees of freedom

# Create a sequence of x values
x_values <- seq(-4, 4, by = 0.01)  # Adjust the range and step size as needed

# Calculate the PDF values for the t-distribution
pdf_t <- dt(x_values, df)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
quantiles <- c(0.05, 1)

#quantile_values <- qnorm(quantiles, mean = 0, sd = 1)

t_critical_low <- qt(quantiles[1], df = df)
t_critical_up <-  qt(quantiles[2], df = df)

# Create a data frame for plotting
pdf_data <- data.frame(x = x_values, Probability = pdf_t)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pdf_data, aes(x = x)) +
  geom_line(aes(y = Probability), linewidth = 1, color = "black", linetype = "solid") +
  geom_vline(xintercept = t_critical_low, linewidth = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = t_critical_up, linewidth = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = observed, linewidth = 2, linetype = "dashed", color = "red") +
  annotate("text", x = t_critical_low-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[1], t_critical_low), hjust = 0, angle = 90) +
  annotate("text", x = t_critical_up-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[2], t_critical_up), hjust = 0, angle = 90) +
  annotate("text", x = observed-0.15, y = 0.2, label = 'observed', hjust = 0, angle = 90)+
  annotate("text", x = 2.5, y = 0.6, label = sprintf("df(%.0f)", df), hjust = 0)+
  labs(title = "PDF —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –°—Ç—å—é–¥–µ–Ω—Ç–∞", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏")


```

 
### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ R
 
```{r}

library(BSDA)


# Sample data for group A and group B
group_A <- c(15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25)
group_A <- group_A + 2
group_B <- c(10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30)


z_test <- z.test(x = group_A, y = group_B, alternative = "two.sided", sigma.x =sd(group_A), sigma.y = sd(group_B))

# Perform a t-test for the means of two independent samples (assuming equal variances)
t_test <- t.test(group_B, group_A, var.equal = TRUE)


# Perform a t-test for the means of two independent samples (assuming unequal variances)
t_test_Welch <- t.test(group_B, group_A, var.equal = FALSE)


print(t_test_Welch)
print(t_test)
print(z_test)


```


## –ì–∏–ø–æ—Ç–µ–∑—ã –æ –¥–æ–ª—è—Ö

### Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è –¥–æ–ª–∏ 

```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞ ggplot2
library(ggplot2)

#?quantile

observed=-2

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π x
x_values <- seq(-4, 4, by = 0.01)

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –ü–ª–æ—Ç–Ω–æ—Å—Ç–∏ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (PDF) –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
pdf_normal <- dnorm(x_values, mean = 0, sd = 1)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
quantiles <- c(0.05, 1)

quantile_values <- qnorm(quantiles, mean = 0, sd = 1)

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
pdf_data <- data.frame(x = x_values, Probability = pdf_normal)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pdf_data, aes(x = x)) +
  geom_line(aes(y = Probability), linewidth = 1, color = "black", linetype = "solid") +
  geom_vline(xintercept = quantile_values, linewidth = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = observed, linewidth = 2, linetype = "dashed", color = "red") +
  annotate("text", x = quantile_values[1]-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[1], quantile_values[1]), hjust = 0, angle = 90) +
  annotate("text", x = quantile_values[2]-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[2], quantile_values[2]), hjust = 0, angle = 90) +
  annotate("text", x = observed-0.15, y = 0.2, label = 'observed', hjust = 0, angle = 90)+
  labs(title = "PDF —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏")

```


### –¢–æ—á–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è –¥–æ–ª–∏ 


```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
library(ggplot2)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
n <- 10   # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø—ã—Ç–∞–Ω–∏–π
p <- 0.5  # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞ –≤ –∫–∞–∂–¥–æ–º –∏—Å–ø—ã—Ç–∞–Ω–∏–∏ (–∏—Å—Ç–∏–Ω–∞)

–Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ = 5

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —á–∏—Å–ª–∞ —É—Å–ø–µ—Ö–æ–≤
x_values <- 1:n

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –ü–§–† (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –º–∞—Å—Å–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏) –¥–ª—è –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
pmf_binomial <- dbinom(x_values, size = n, prob = p)

# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—Ä–µ–π–º–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è
pmf_data <- data.frame(x = x_values, –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å = pmf_binomial)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
–∫–≤–∞–Ω—Ç–∏–ª–∏ <- c(0.025, 0.975)

# –†–∞—Å—á–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–∫–≤–∞–Ω—Ç–∏–ª–µ–π)
critical_value_left <- qbinom(–∫–≤–∞–Ω—Ç–∏–ª–∏[1], size = n, prob = p)
critical_value_right <- qbinom(–∫–≤–∞–Ω—Ç–∏–ª–∏[2], size = n, prob = p)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –ü–§–† –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pmf_data, aes(x = factor(x), y = –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)) +
  geom_bar(stat = "identity", fill = "blue", color = "black", width = 0.5) +
  labs(title = "PMF –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è", x = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—Ö–æ–≤", y = "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å") +
  theme_minimal() +
  geom_vline(xintercept = critical_value_left, linetype = "solid", color = "blue", size = 2) +
  geom_vline(xintercept = critical_value_right, linetype = "solid", color = "blue", size = 2) +
  geom_vline(xintercept = –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ, size = 2, linetype = "dashed", color = "red") +
  annotate("text", x = critical_value_left + n/50, y = max(pmf_binomial), label = sprintf("Q(%.3f)=%.2f", –∫–≤–∞–Ω—Ç–∏–ª–∏[1], critical_value_left), color = "black", hjust = 1, angle = 90) +
  annotate("text", x = critical_value_right + n/50, y = max(pmf_binomial), label = sprintf("Q(%.3f)=%.2f", –∫–≤–∞–Ω—Ç–∏–ª–∏[2], critical_value_right), color = "black", hjust = 1, angle = 90) +
  annotate("text", x = –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ - n/50, y = max(pmf_binomial), label = '–Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ', hjust = 1, angle = 90)


```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ R


```{r}

# –î–∞–Ω–Ω—ã–µ 
successes <- 30
trials <- 50

# –¢–æ—á–Ω—ã–π –±–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç
exact_binom_test <- binom.test(successes, trials, alternative = "two.sided")

# –ê—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –¥–ª—è –¥–æ–ª–∏
asymptotic_prop_test <- prop.test(successes, trials, alternative = "two.sided")

# –í—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
print("–¢–æ—á–Ω—ã–π –±–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç:")
print(exact_binom_test)

print("\n–ê—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –¥–ª—è –¥–æ–ª–∏:")
print(asymptotic_prop_test)


```



## –ì–∏–ø–æ—Ç–µ–∑—ã –æ —Ä–∞–∑–Ω–∏—Ü–µ –¥–æ–ª–µ–π

### Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ –¥–æ–ª–µ–π –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫ –∏ –∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫

```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞ ggplot2
library(ggplot2)

#?quantile

observed=-3.125

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π x
x_values <- seq(-4, 4, by = 0.01)

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –ü–ª–æ—Ç–Ω–æ—Å—Ç–∏ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (PDF) –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
pdf_normal <- dnorm(x_values, mean = 0, sd = 1)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
quantiles <- c(0.05, 1)

quantile_values <- qnorm(quantiles, mean = 0, sd = 1)

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
pdf_data <- data.frame(x = x_values, Probability = pdf_normal)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pdf_data, aes(x = x)) +
  geom_line(aes(y = Probability), linewidth = 1, color = "black", linetype = "solid") +
  geom_vline(xintercept = quantile_values, linewidth = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = observed, linewidth = 2, linetype = "dashed", color = "red") +
  annotate("text", x = quantile_values[1]-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[1], quantile_values[1]), hjust = 0, angle = 90) +
  annotate("text", x = quantile_values[2]-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[2], quantile_values[2]), hjust = 0, angle = 90) +
  annotate("text", x = observed-0.15, y = 0.2, label = 'observed', hjust = 0, angle = 90)+
  labs(title = "PDF —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏")




```



### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ R


```{r}

# –î–∞–Ω–Ω—ã–µ
success_group1 <- 30
total_group1 <- 50

success_group2 <- 40
total_group2 <- 50

# Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ –¥–æ–ª–µ–π –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫
z_test_independent <- prop.test(c(success_group1, success_group2), c(total_group1, total_group2), alternative = "two.sided", correct = )

# –í—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
print("Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ –¥–æ–ª–µ–π –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫:")
print(z_test_independent)



```


```{r}

# –î–∞–Ω–Ω—ã–µ 
success_before <- c(15, 20)
total_before <- c(25, 30)

success_after <- c(25, 28)
total_after <- c(30, 30)

# Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ –¥–æ–ª–µ–π –¥–ª—è –∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫
z_test_dependent <- prop.test(matrix(c(success_after, success_before, total_after - success_after, total_before - success_before), ncol = 2), 
                              alternative = "two.sided", correct = FALSE)

# –í—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
print("Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ –¥–æ–ª–µ–π –¥–ª—è –∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫:")
print(z_test_dependent)


```

## –ì–∏–ø–æ—Ç–µ–∑—ã –æ –¥–∏—Å–ø–µ—Ä—Å–∏–∏


### ùùå^ùüê ‚Äì –∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏ (—Ç–æ—á–Ω—ã–π)


```{r}


# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
library(ggplot2)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–µ–π —Å–≤–æ–±–æ–¥—ã –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç
df <- 9  # –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ —Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π x
x_values <- seq(0.01, 30, by = 0.01)  # –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –∏ —à–∞–≥ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π PDF –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç
pdf_chi_squared <- dchisq(x_values, df)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
quantiles <- c(0.25, 0.975)

# –†–∞—Å—á–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç
critical_value_lower <- qchisq(quantiles[1], df)
critical_value_upper <- qchisq(quantiles[2], df)

# –†–∞—Å—á–µ—Ç –Ω–∞–±–ª—é–¥–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
observed_chi_squared <- 14.4  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–µ —Ä–µ–∞–ª—å–Ω–æ–µ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

# –°–æ–∑–¥–∞–Ω–∏–µ data frame –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
pdf_data <- data.frame(x = x_values, Probability = pdf_chi_squared)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç
ggplot(pdf_data, aes(x = x, y = Probability)) +
  geom_line(size = 1, color = "black") +
  labs(title = "PDF —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏") +
  theme_minimal() +
  geom_vline(xintercept = c(critical_value_lower, critical_value_upper, observed_chi_squared),
             linetype = c("solid", "solid", "dashed"),
             color = c("blue", "blue", "red"),
             size = c(2, 2, 2)) +
  annotate("text", x = critical_value_lower - 0.5, y = 0.1, label = sprintf("Q(%.3f)=%.2f", quantiles[1], critical_value_lower), hjust = 1, angle = 90) +
  annotate("text", x = critical_value_upper - 0.5, y = 0.1, label = sprintf("Q(%.3f)=%.2f", quantiles[2], critical_value_upper), hjust = 1, angle = 90) +
  annotate("text", x = observed_chi_squared - 0.5, y = 0.1, label = '–Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ', hjust = 1, angle = 90) +
  annotate("text", x = critical_value_upper + 5, y = 0.1, label = sprintf("df = %.0f", df), hjust = 1)


```


### F –∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω–∏—Ü—ã –¥–∏—Å–ø–µ—Ä—Å–∏–π (—Ç–æ—á–Ω—ã–π)

```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
library(ggplot2)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç–µ–ø–µ–Ω–µ–π —Å–≤–æ–±–æ–¥—ã –¥–ª—è F-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
df1 <- 10  # –°—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã —á–∏—Å–ª–∏—Ç–µ–ª—è
df2 <- 10  # –°—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π x
x_values <- seq(0.01, 5, by = 0.01)  # –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –∏ —à–∞–≥ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π PDF –¥–ª—è F-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
pdf_fisher <- df(x_values, df1, df2)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ (–∞–ª—å—Ñ–∞) –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
quantiles <- c(0, 0.95)  # –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# –†–∞—Å—á–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è F-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
critical_value_lower <- qf(quantiles[1], df1, df2)
critical_value_upper <- qf(quantiles[2], df1, df2)

# –†–∞—Å—á–µ—Ç –Ω–∞–±–ª—é–¥–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è F (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
observed_f_value <- 1  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–µ —Ä–µ–∞–ª—å–Ω–æ–µ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

# –°–æ–∑–¥–∞–Ω–∏–µ data frame –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
pdf_data <- data.frame(x = x_values, Probability = pdf_fisher)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ F-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pdf_data, aes(x = x, y = Probability)) +
  geom_line(size = 1, color = "black") +
  labs(title = "PDF F-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –§–∏—à–µ—Ä–∞-–°–Ω–µ–¥–µ–∫–æ—Ä–∞", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏") +
  theme_minimal() +
  geom_vline(xintercept = c(critical_value_lower, critical_value_upper, observed_f_value),
             linetype = c("solid", "solid", "dashed"),
             color = c("blue", "blue", "red"),
             size = c(2, 2, 2)) +
  annotate("text", x = critical_value_lower-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[1], critical_value_lower), hjust = 0, angle = 90) +
  annotate("text", x = critical_value_upper-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[2], critical_value_upper), hjust = 0, angle = 90) +
  annotate("text", x = observed_f_value-0.15, y = 0.2, label = '–Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ', hjust = 0, angle = 90) +
  annotate("text", x = 4, y = 0.6, label = sprintf("df1=%.0f, df2=%.0f", df1, df2), hjust = 0)



```


### –¢–µ—Å—Ç –§–∏—à–µ—Ä–∞ –¥–ª—è –æ—Ç–Ω–æ—à–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ä—Å–∏–π vs t-test 

```{r}


# Sample data for group A and group B
group_A <- c(15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25)
group_B <- c(10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30)

?var.test


# Perform an F-test for equality of variances
f_test_result <- var.test(group_B, group_A)

# Perform a t-test for the means of two independent samples (assuming unequal variances)
t_test_result <- t.test(group_B, group_A, var.equal = FALSE)

# Print the F-test and t-test results
cat("F-Test Result (Equality of Variances):\n")
print(f_test_result)

cat("\nT-Test Result (Equality of Means):\n")
print(t_test_result)


# Check if the variances are significantly different
if (f_test_result$p.value < 0.05) {
  cat("The variances are significantly different, reject H0 for variances.\n")
} else {
  cat("There is no significant difference in variances, fail to reject H0 for variances.\n")
}

# Check if the means are significantly different
if (t_test_result$p.value < 0.05) {
  cat("The means are significantly different, reject H0 for means.\n")
} else {
  cat("There is no significant difference in means, fail to reject H0 for means.\n")
}

```

#=========================================================================================

# –ö–≤–∞–Ω—Ç–∏–ª–∏

```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞ ggplot2
library(ggplot2)

#?quantile

observed=1.86

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π x
x_values <- seq(-4, 4, by = 0.01)

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –ü–ª–æ—Ç–Ω–æ—Å—Ç–∏ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (PDF) –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
pdf_normal <- dnorm(x_values, mean = 0, sd = 1)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
quantiles <- c(0, 0.95)

quantile_values <- qnorm(quantiles, mean = 0, sd = 1)

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
pdf_data <- data.frame(x = x_values, Probability = pdf_normal)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pdf_data, aes(x = x)) +
  geom_line(aes(y = Probability), linewidth = 1, color = "black", linetype = "solid") +
  geom_vline(xintercept = quantile_values, linewidth = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = observed, linewidth = 2, linetype = "dashed", color = "red") +
  annotate("text", x = quantile_values[1]-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[1], quantile_values[1]), hjust = 0, angle = 90) +
  annotate("text", x = quantile_values[2]-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[2], quantile_values[2]), hjust = 0, angle = 90) +
  annotate("text", x = observed-0.15, y = 0.2, label = 'observed', hjust = 0, angle = 90)+
  labs(title = "PDF —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏")




```


```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
library(ggplot2)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
n <- 100  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø—ã—Ç–∞–Ω–∏–π
p <- 0.5  # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞ –≤ –∫–∞–∂–¥–æ–º –∏—Å–ø—ã—Ç–∞–Ω–∏–∏ (–∏—Å—Ç–∏–Ω–∞)

–Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ = 70

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —á–∏—Å–ª–∞ —É—Å–ø–µ—Ö–æ–≤
x_values <- 1:n

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –ü–§–† (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –º–∞—Å—Å–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏) –¥–ª—è –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
pmf_binomial <- dbinom(x_values, size = n, prob = p)

# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—Ä–µ–π–º–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è
pmf_data <- data.frame(x = x_values, –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å = pmf_binomial)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
–∫–≤–∞–Ω—Ç–∏–ª–∏ <- c(0, 0.95)

# –†–∞—Å—á–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–∫–≤–∞–Ω—Ç–∏–ª–µ–π)
critical_value_left <- qbinom(–∫–≤–∞–Ω—Ç–∏–ª–∏[1], size = n, prob = p)
critical_value_right <- qbinom(–∫–≤–∞–Ω—Ç–∏–ª–∏[2], size = n, prob = p)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –ü–§–† –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pmf_data, aes(x = factor(x), y = –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)) +
  geom_bar(stat = "identity", fill = "blue", color = "black", width = 0.5) +
  labs(title = "PMF –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è", x = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—Ö–æ–≤", y = "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å") +
  theme_minimal() +
  geom_vline(xintercept = critical_value_left, linetype = "solid", color = "blue", size = 2) +
  geom_vline(xintercept = critical_value_right, linetype = "solid", color = "blue", size = 2) +
  geom_vline(xintercept = –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ, size = 2, linetype = "dashed", color = "red") +
  annotate("text", x = critical_value_left + n/50, y = max(pmf_binomial), label = sprintf("Q(%.3f)=%.2f", –∫–≤–∞–Ω—Ç–∏–ª–∏[1], critical_value_left), color = "black", hjust = 1, angle = 90) +
  annotate("text", x = critical_value_right + n/50, y = max(pmf_binomial), label = sprintf("Q(%.3f)=%.2f", –∫–≤–∞–Ω—Ç–∏–ª–∏[2], critical_value_right), color = "black", hjust = 1, angle = 90) +
  annotate("text", x = –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ - n/50, y = max(pmf_binomial), label = '–Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ', hjust = 1, angle = 90)



```





```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞ ggplot2
library(ggplot2)

#?quantile

observed=-0.805

# Define the degrees of freedom for the t-distribution
df <- 18  # Degrees of freedom

# Create a sequence of x values
x_values <- seq(-4, 4, by = 0.01)  # Adjust the range and step size as needed

# Calculate the PDF values for the t-distribution
pdf_t <- dt(x_values, df)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
quantiles <- c(0.025, 0.975)

#quantile_values <- qnorm(quantiles, mean = 0, sd = 1)

t_critical_low <- qt(quantiles[1], df = df)
t_critical_up <-  qt(quantiles[2], df = df)

# Create a data frame for plotting
pdf_data <- data.frame(x = x_values, Probability = pdf_t)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pdf_data, aes(x = x)) +
  geom_line(aes(y = Probability), size = 1, color = "black", linetype = "solid") +
  geom_vline(xintercept = t_critical_low, size = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = t_critical_up, size = 2, linetype = "solid", color = "blue") +
  geom_vline(xintercept = observed, size = 2, linetype = "dashed", color = "red") +
  annotate("text", x = t_critical_low-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[1], t_critical_low), hjust = 0, angle = 90) +
  annotate("text", x = t_critical_up-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[2], t_critical_up), hjust = 0, angle = 90) +
  annotate("text", x = observed-0.15, y = 0.2, label = 'observed', hjust = 0, angle = 90)+
  annotate("text", x = 2.5, y = 0.6, label = sprintf("df(%.0f)", df), hjust = 0)+
  labs(title = "PDF —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –°—Ç—å—é–¥–µ–Ω—Ç–∞", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏")


```





```{r}


# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
library(ggplot2)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–µ–π —Å–≤–æ–±–æ–¥—ã –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç
df <- 8  # –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ —Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π x
x_values <- seq(0.01, 30, by = 0.01)  # –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –∏ —à–∞–≥ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π PDF –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç
pdf_chi_squared <- dchisq(x_values, df)

# –ö–≤–∞–Ω—Ç–∏–ª–∏
quantiles <- c(0, 0.95)

# –†–∞—Å—á–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç
critical_value_lower <- qchisq(quantiles[1], df)
critical_value_upper <- qchisq(quantiles[2], df)

# –†–∞—Å—á–µ—Ç –Ω–∞–±–ª—é–¥–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
observed_chi_squared <- 8  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–µ —Ä–µ–∞–ª—å–Ω–æ–µ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

# –°–æ–∑–¥–∞–Ω–∏–µ data frame –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
pdf_data <- data.frame(x = x_values, Probability = pdf_chi_squared)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç
ggplot(pdf_data, aes(x = x, y = Probability)) +
  geom_line(size = 1, color = "black") +
  labs(title = "PDF —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏") +
  theme_minimal() +
  geom_vline(xintercept = c(critical_value_lower, critical_value_upper, observed_chi_squared),
             linetype = c("solid", "solid", "dashed"),
             color = c("blue", "blue", "red"),
             size = c(2, 2, 2)) +
  annotate("text", x = critical_value_lower - 0.5, y = 0.1, label = sprintf("Q(%.3f)=%.2f", quantiles[1], critical_value_lower), hjust = 1, angle = 90) +
  annotate("text", x = critical_value_upper - 0.5, y = 0.1, label = sprintf("Q(%.3f)=%.2f", quantiles[2], critical_value_upper), hjust = 1, angle = 90) +
  annotate("text", x = observed_chi_squared - 0.5, y = 0.1, label = '–Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ', hjust = 1, angle = 90) +
  annotate("text", x = critical_value_upper + 5, y = 0.1, label = sprintf("df = %.0f", df), hjust = 1)


```






```{r}


# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
library(ggplot2)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç–µ–ø–µ–Ω–µ–π —Å–≤–æ–±–æ–¥—ã –¥–ª—è F-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
df1 <- 10  # –°—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã —á–∏—Å–ª–∏—Ç–µ–ª—è
df2 <- 10  # –°—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π x
x_values <- seq(0.01, 5, by = 0.01)  # –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –∏ —à–∞–≥ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# –†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π PDF –¥–ª—è F-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
pdf_fisher <- df(x_values, df1, df2)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ (–∞–ª—å—Ñ–∞) –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
quantiles <- c(0, 0.95)  # –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# –†–∞—Å—á–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è F-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
critical_value_lower <- qf(quantiles[1], df1, df2)
critical_value_upper <- qf(quantiles[2], df1, df2)

# –†–∞—Å—á–µ—Ç –Ω–∞–±–ª—é–¥–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è F (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
observed_f_value <- 1  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–µ —Ä–µ–∞–ª—å–Ω–æ–µ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

# –°–æ–∑–¥–∞–Ω–∏–µ data frame –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
pdf_data <- data.frame(x = x_values, Probability = pdf_fisher)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ PDF –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ F-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(pdf_data, aes(x = x, y = Probability)) +
  geom_line(size = 1, color = "black") +
  labs(title = "PDF F-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –§–∏—à–µ—Ä–∞-–°–Ω–µ–¥–µ–∫–æ—Ä–∞", x = "x", y = "–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏") +
  theme_minimal() +
  geom_vline(xintercept = c(critical_value_lower, critical_value_upper, observed_f_value),
             linetype = c("solid", "solid", "dashed"),
             color = c("blue", "blue", "red"),
             size = c(2, 2, 2)) +
  annotate("text", x = critical_value_lower-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[1], critical_value_lower), hjust = 0, angle = 90) +
  annotate("text", x = critical_value_upper-0.15, y = 0.2, label = sprintf("Q(%.3f)=%.2f", quantiles[2], critical_value_upper), hjust = 0, angle = 90) +
  annotate("text", x = observed_f_value-0.15, y = 0.2, label = '–Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ', hjust = 0, angle = 90) +
  annotate("text", x = 4, y = 0.6, label = sprintf("df1=%.0f, df2=%.0f", df1, df2), hjust = 0)



```


## –¢–µ—Å—Ç –§–∏—à–µ—Ä–∞ –¥–ª—è –æ—Ç–Ω–æ—à–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ä—Å–∏–π vs t-test

```{r}


# Sample data for group A and group B
group_A <- c(15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25)
group_B <- c(10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30)

?var.test


# Perform an F-test for equality of variances
f_test_result <- var.test(group_B, group_A)

# Perform a t-test for the means of two independent samples (assuming unequal variances)
t_test_result <- t.test(group_B, group_A, var.equal = FALSE)

# Print the F-test and t-test results
cat("F-Test Result (Equality of Variances):\n")
print(f_test_result)

cat("\nT-Test Result (Equality of Means):\n")
print(t_test_result)

# Check if the variances are significantly different
if (f_test_result$p.value < 0.05) {
  cat("The variances are significantly different, reject H0 for variances.\n")
} else {
  cat("There is no significant difference in variances, fail to reject H0 for variances.\n")
}

# Check if the means are significantly different
if (t_test_result$p.value < 0.05) {
  cat("The means are significantly different, reject H0 for means.\n")
} else {
  cat("There is no significant difference in means, fail to reject H0 for means.\n")
}


```







# –ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ 

## 1. Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –∏ —Ç–æ—á–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è –¥–æ–ª–∏ –∏ —Ä–∞–∑–Ω–∏—Ü—ã –¥–æ–ª–µ–π 

## 2. Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –∏ —Ç–æ—á–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ –∏ —Ä–∞–∑–Ω–∏—Ü—ã —Å—Ä–µ–¥–Ω–∏—Ö 

## 3. –¢–µ—Å—Ç –§–∏—à–µ—Ä–∞ –¥–ª—è –æ—Ç–Ω–æ—à–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ä—Å–∏–π

# –ù–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ (–†–∞–Ω–≥–æ–≤—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏) 

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏-–£–∏–ª–∫–æ–∫—Å–æ–Ω–∞ (–æ–¥–Ω–æ–≤—ã–±–æ—Ä–æ—á–Ω—ã–π)

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏-–£–∏–ª–∫–æ–∫—Å–æ–Ω–∞ (–¥–≤—É—Ö–≤—ã–±–æ—Ä–æ—á–Ω—ã–π) –¥–ª—è –∑–∞–≤–∏—Å–∏–º—ã—Ö 

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏-–£–∏–ª–∫–æ–∫—Å–æ–Ω–∞ (–¥–≤—É—Ö–≤—ã–±–æ—Ä–æ—á–Ω—ã–π) –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö 

# –ö—Ä–∏—Ç–µ—Ä–∏–∏ —Å–æ–≥–ª–∞—Å–∏—è 

## –ö—Ä–∏—Ç–µ—Ä–∏–π –ü–∏—Ä—Å–æ–Ω–∞



# –ù–∞ –∫–∞–∂–¥—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π –ø—Ä–∏–º–µ—Ä

# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å






M–µ—Ç–æ–¥—ã –æ–¥–Ω–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã). –û–±–ª–∞—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.

–ó–∞ –∫–∞–∂–¥—ã–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º —Ç–µ—Å—Ç–æ–º —Å—Ç–æ–∏—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞

# T–µ—Å—Ç—ã –Ω–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö

## –û–¥–Ω–æ–≤—ã–±–æ—Ä–æ—á–Ω—ã–π t-test
H0: —Å—Ä–µ–¥–Ω–µ–µ –≤ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ (–ø–æ–ø—É–ª—è—Ü–∏–∏) —Ä–∞–≤–Ω–æ –Ω—É–ª—é



## –î–≤—É—Ö–≤—ã–±–æ—Ä–æ—á–Ω—ã–π t-test –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫
H0: —Å—Ä–µ–¥–Ω–µ–µ –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏ –ê —Ä–∞–≤–Ω–æ —Å—Ä–µ–¥–Ω–µ–º—É –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏ B



## –î–≤—É—Ö–≤—ã–±–æ—Ä–æ—á–Ω—ã–π t-test –¥–ª—è –∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫
H0: —Å—Ä–µ–¥–Ω–µ–µ –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏ –ê —Ä–∞–≤–Ω–æ —Å—Ä–µ–¥–Ω–µ–º—É –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏ B, –≥–¥–µ –æ–±–µ –≤—ã–±–æ—Ä–∫–∏ –ø–æ–ª—É—á–µ–Ω—ã –Ω–∞ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞—Ö –¥–æ –∏ –ø–æ—Å–ª–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è (pre-post trials)

–ü—Ä–æ–±–ª–µ–º–∞ t-test –∏–∑–æ–±—Ä–µ—Ç—ë–Ω –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è. 2 –æ–ø—Ü–∏–∏:

1. –£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –æ–±—ä—ë–º –≤—ã–±–æ—Ä–∫–∏ –¥–æ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (30, 50, 70, 100 –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è)
2. –ù–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ç–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏-–£–∏–ª–∫–æ–∫—Å–æ–Ω–∞)


## –û–¥–Ω–æ–≤—ã–±–æ—Ä–æ—á–Ω—ã–π —Ç–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏-–£–∏–ª–∫–æ–∫—Å–æ–Ω–∞
H0: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –∏–∑–º–µ—Ä—è–µ–º–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –±—É–¥–µ—Ç –±–æ–ª—å—à–µ –Ω–µ–∫–æ–≥–æ –ø–æ—Ä–æ–≥–∞, —Ä–∞–≤–Ω–∞ 
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Ç–æ–≥–æ, —á—Ç–æ –∏–∑–º–µ—Ä—è–µ–º–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –±—É–¥–µ—Ç –º–µ–Ω—å—à–µ —ç—Ç–æ–≥–æ –ø–æ—Ä–æ–≥–∞


```{r}

data <- c(6, 4, 4, 7, 8)
mu_0 <- 5

wilcox.test(data, mu = mu_0, alternative = "greater")


# The one-sample Wilcoxon test is used to compare our observations to a given default value‚Äîa value that you specify based on your beliefs or a theoretical expectation for example. In other words, it is used to determine if a group is significantly different from a known or hypothesized population value on the variable of interest.
# 
# Since the test statistic is computed based on the ranks of the difference between the observed values and the default value (making it a non-parametric test), the one-sample Wilcoxon test is more appropriate than a one-sample t-test when the observations do not follow a normal distribution.
# 
# The goal of this test is to verify whether the observations are significantly different from our default value. In terms of null and alternative hypotheses, we have (for a two-tailed test):
# 
# H0:
# \(H_0:\) location of the data is equal to the chosen value
# H1:
# \(H_1:\) location of the data is different from the chosen value
# In other words, a significant result (i.e., a rejection of the null hypothesis) suggests that the location of the data is different from the chosen value.
# 
# Note that some authors suggest that this test is a test of the median, that is (for a two-tailed test):
# 
# H0:
# \(H_0:\) the median is equal to the chosen value
# H1:
# \(H_1:\) the median is different from the chosen value
# However, this is the case only if the data are symmetric. Without further assumptions about the distribution of the data, the one-sample Wilcoxon test is not a test of the median but a test about the location of the data.1
# 
# Note that although the normality assumption is not required, the independence assumption must still be verified. This means that observations must be independent of one another (usually, random sampling is sufficient to have independence).


data <- c(17, 5, 1, 10, 4, 18, 17, 15, 7, 4, 5, 14, 20, 18, 15)
mu_0 <- 10
hist(data)



wilcox.test(data, mu = mu_0, correct=TRUE)

data1 <- c(48, 54, 67, 56, 55, 55, 90, 71, 72, 69)
data2 <- c(47, 52, 60, 60, 58, 60, 70, 81, 87, 60)

wilcox.test(data2, data1, paired = TRUE)


# Significance level (alpha)
alpha <- 0.05

# Sample size (n)
n <- 5

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ (–∞–ª—å—Ñ–∞) –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
quantiles <- c(0.25, 0.975)  # –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# Calculate the critical value for a two-tailed test (default)
critical_value <- qsignrank(1 - alpha/2, n)

# Calculate the critical value for a one-tailed test (e.g., upper-tailed)
#critical_value <- qsignrank(quantiles[2], n)

# Display the critical value
cat("Critical Value:", critical_value, "\n")


?chisq.test()


```



## –î–≤—É—Ö–≤—ã–±–æ—Ä–æ—á–Ω—ã–π —Ç–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏-–£–∏–ª–∫–æ–∫—Å–æ–Ω–∞ –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫ 
H0: –í –ø–æ–ø—É–ª—è—Ü–∏–∏ –ê –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ø—É–ª—è—Ü–∏–∏ –í –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç


## –î–≤—É—Ö–≤—ã–±–æ—Ä–æ—á–Ω—ã–π —Ç–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏-–£–∏–ª–∫–æ–∫—Å–æ–Ω–∞ –¥–ª—è –∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫ 
H0: –í –ø–æ–ø—É–ª—è—Ü–∏–∏ –ê –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ø—É–ª—è—Ü–∏–∏ –í –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç



```{r}

n <- 100

t1 <- 1 # –°—Ä–µ–¥–Ω—è—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–æ–ª–µ–∑–Ω–∏ –≤ –≥—Ä—É–ø–ø–µ 1

t2 <- 1.5 # –°—Ä–µ–¥–Ω—è—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–æ–ª–µ–∑–Ω–∏ –≤ –≥—Ä—É–ø–ø–µ 2

sample_1 <- sort( round(rexp(n, 1/t1),2) )
sample_2 <- sort( round(rexp(n, 1/t2),2) )

df1 <- data.frame(n1 = 1:n,
                  d1  = sort(sample_1))

df2 <- data.frame(n2 = 1:n,
                  d2  = sort(sample_2))

df <- merge(df1, df2) %>% 
  mutate(rez = case_when(
    d1 > d2 ~ +1,
    d1 < d2 ~ -1,
    TRUE ~ 0)) %>% 
  dplyr::select(-c("d1", "d2")) %>% 
  pivot_wider(names_from = n2, values_from = rez) %>% 
  tibble::column_to_rownames('n1')

pheatmap::pheatmap(df,
                   cluster_cols = FALSE,
                   cluster_rows = FALSE)


wilcox.test(sample_1, sample_2, conf.int = TRUE) # W - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Å–Ω–µ–Ω—å–∫–∏—Ö

?wilcox.test





#create a vector for each group
new <- c(3, 5, 1, 4, 3, 5)
placebo <- c(4, 8, 6, 2, 1, 9)

#perform the Mann Whitney U test
wilcox.test(new, placebo)



```

—Å—Ç–æ–ª–±—Ü—ã  - sample1 (–∫—Ä–∞—Å–Ω—ã–π –µ—Å–ª–∏ –¥–æ–ª—å—à–µ –±–æ–ª–µ–ª –∏–∑ 1 –≥—Ä—É–ø–ø—ã)
—Å—Ç—Ä–æ–∫–∏   - sample2 (—Å–∏–Ω–∏–π –µ—Å–ª–∏ –¥–æ–ª—å—à–µ –±–æ–ª–µ–ª –∏–∑ 2 –≥—Ä—É–ø–ø—ã)

–õ–æ–º–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –∫–æ–≥–¥–∞ —É –≤—ã–±–æ—Ä–æ–∫ —Ä–∞–∑–Ω—ã–µ –¥–∏—Å–ø–µ—Ä—Å–∏–∏!!!

–í –≥—Ä—É–ø–ø–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ –∑–Ω–∞—á–∏–º–æ —á–∞—â–µ –Ω–∞–±–ª—é–¥–∞–ª—Å—è –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –≥–µ–º–æ–≥–ª–æ–±–∏–Ω–∞
—á–µ–º –≤ –≥—Ä—É–ø–ø–µ –ø–ª–∞—Ü–µ–±–æ


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

### —Ç–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞
H0: –≤—ã–±–æ—Ä–∫–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é

```{r}





```


### —Ç–µ—Å—Ç –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞-–°–º–∏—Ä–Ω–æ–≤–∞
H0: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–≤—É—Ö –≤—ã–±–æ—Ä–æ–∫ —Å–æ–≤–ø–∞–¥–∞—é—Ç


```{r}




```


## –¢–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏ (–∞—Å—Å–æ—Ü–∏–∞—Ü–∏—è –º–µ–∂–¥—É –ø–∞—Ä–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)

–ú.–±. 2X3, 3X3, etc. –ï—Å—Ç—å –ª–∏ –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å (–∞—Å—Å–æ—Ü–∏–∞—Ü–∏—è) –º–µ–∂–¥—É 2 –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –∏—Å—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ —Ç–µ—Ä–∞–ø–∏–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è)

H0: –ø—Ä–∏–∑–Ω–∞–∫ –ê –Ω–µ –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω —Å –ø—Ä–∏–∑–Ω–∞–∫–æ–º –í

```{r}

# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –¥–≤—É–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –∏ –∏—Å—Ö–æ–¥)
exposure <- c("A", "B", "A", "B", "B", "A", "B", "B", "B")
outcome <- c("X", "Y", "X", "Y", "Y", "X", "X", "X", "Y")

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
contingency_table <- table(exposure, outcome)

# –í—ã–≤–æ–¥ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
print(contingency_table)


```

–ù–µ –≥–æ–≤–æ—Ä–∏—Ç –æ –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å–≤—è–∑–∏ (–ª—É—á—à–µ –≥–æ–≤–æ—Ä–∏—Ç—å –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—è –∏–ª–∏ –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏)


### –ö–∞–∫ —Ç–∞–±–ª–∏—á–∫–∞ –±—ã–ª–∞ –ø–æ–ª—É—á–µ–Ω–∞

#### –ü–æ–ø–µ—Ä–µ—á–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ (–æ–¥–Ω–∞ –≥—Ä—É–ø–ø–∞)

–ó–Ω–∞—é –ª–∏ —è –∑–∞—Ä–∞–Ω–µ–µ –∫–∞–∫ –ø–∞—Ü–∏–µ–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –ø–æ –≥—Ä—É–ø–ø–∞–º?

–ú–æ–≥—É –ª–∏ –∑–∞—Ä–∞–Ω–µ–µ —Å–∫–∞–∑–∞—Ç—å —Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º, –∞ —Å–∫–æ–ª—å–∫–æ —Å 
–Ω–µ–Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º?

–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ –∫–∞–∫ –¥–ª—è –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è —Ç–∞–∫ –∏ –¥–ª—è –∏—Å—Ö–æ–¥–∞!!!


```{r}

# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –¥–≤—É–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –∏ –∏—Å—Ö–æ–¥)
exposure <- c("–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã -", 
              "–í–∏—Ç–∞–º–∏–Ω—ã -", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã -", 
              "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +")

outcome <- c("–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -", 
             "–ò—Å—Ö–æ–¥ -", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -", 
             "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +")

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
contingency_table <- table(exposure, outcome)

# –í—ã–≤–æ–¥ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
print(contingency_table)


```


#### –ö–æ–≥–æ—Ä—Ç–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ (2 –≥—Ä—É–ø–ø—ã)

–ó–Ω–∞—é –ª–∏ —è –∑–∞—Ä–∞–Ω–µ–µ –∫–∞–∫ –ø–∞—Ü–∏–µ–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –ø–æ –≥—Ä—É–ø–ø–∞–º?

–ú–æ–≥—É –ª–∏ –∑–∞—Ä–∞–Ω–µ–µ —Å–∫–∞–∑–∞—Ç—å —Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º, –∞ —Å–∫–æ–ª—å–∫–æ —Å 
–Ω–µ–Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º?


–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ—Å–ª—É—á–∞–π–Ω–æ –¥–ª—è –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è, –Ω–æ —Å–ª—É—á–∞–π–Ω–æ –¥–ª—è –∏—Å—Ö–æ–¥–∞!!!

```{r}

# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –¥–≤—É–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –∏ –∏—Å—Ö–æ–¥)
exposure <- c("–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã -", 
              "–í–∏—Ç–∞–º–∏–Ω—ã -", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã -", 
              "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +")

outcome <- c("–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -", 
             "–ò—Å—Ö–æ–¥ -", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -", 
             "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +")

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
contingency_table <- table(exposure, outcome)

# –í—ã–≤–æ–¥ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
print(contingency_table)


```

#### –°–ª—É—á–∞–π –∫–æ–Ω—Ç—Ä–æ–ª—å (2 –≥—Ä—É–ø–ø—ã)

–ó–Ω–∞—é –ª–∏ —è –∑–∞—Ä–∞–Ω–µ–µ –∫–∞–∫ –ø–∞—Ü–∏–µ–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –ø–æ –≥—Ä—É–ø–ø–∞–º?

–ú–æ–≥—É –ª–∏ –∑–∞—Ä–∞–Ω–µ–µ —Å–∫–∞–∑–∞—Ç—å —Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º, –∞ —Å–∫–æ–ª—å–∫–æ —Å 
–Ω–µ–Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º?


–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ –¥–ª—è –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è, –Ω–æ –Ω–µ—Å–ª—É—á–∞–π–Ω–æ –¥–ª—è –∏—Å—Ö–æ–¥–∞!!!

```{r}

# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –¥–≤—É–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –∏ –∏—Å—Ö–æ–¥)
exposure <- c("–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã -", 
              "–í–∏—Ç–∞–º–∏–Ω—ã -", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã -", 
              "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +")

outcome <- c("–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -", 
             "–ò—Å—Ö–æ–¥ -", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -", 
             "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +")

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
contingency_table <- table(exposure, outcome)

# –í—ã–≤–æ–¥ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
print(contingency_table)


```


–ú–æ–∂–µ—Ç –ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç—Ä–æ–∫–∞–º –∏ —Å—Ç–æ–ª–±–∏–∫–∞–º –±—ã—Ç—å –Ω–µ—Å–ª—É—á–∞–π–Ω—ã–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ?

1. –ù–∞–±–∏—Ä–∞–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞–≤—à–∏—Ö –∏ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–≤—à–∏—Ö –≤–∏—Ç–∞–º–∏–Ω—ã (10 vs 10)
2. –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π —ç–∫—Å–ø–µ—Ä—Ç –¥–æ–ª–∂–µ–Ω —É–≥–∞–¥–∞—Ç—å –∫—Ç–æ –ø—Ä–∏–Ω–∏–º–∞–ª, –∞ –∫—Ç–æ –Ω–µ—Ç, —Ç–æ –µ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏—Ö –Ω–∞ 2 –≥—Ä—É–ø–ø—ã –ø–æ 10

```{r}

# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –¥–≤—É–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –∏ –∏—Å—Ö–æ–¥)
exposure <- c("–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã -", 
              "–í–∏—Ç–∞–º–∏–Ω—ã -", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã -", 
              "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +",
              "–í–∏—Ç–∞–º–∏–Ω—ã -", "–í–∏—Ç–∞–º–∏–Ω—ã -", "–í–∏—Ç–∞–º–∏–Ω—ã +", 
              "–í–∏—Ç–∞–º–∏–Ω—ã -", "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã +", 
              "–í–∏—Ç–∞–º–∏–Ω—ã +", "–í–∏—Ç–∞–º–∏–Ω—ã -", "–í–∏—Ç–∞–º–∏–Ω—ã -",
              "–í–∏—Ç–∞–º–∏–Ω—ã -", "–í–∏—Ç–∞–º–∏–Ω—ã -")

outcome <- c("–ò—Å—Ö–æ–¥ -", "–ò—Å—Ö–æ–¥ -", "–ò—Å—Ö–æ–¥ -", 
             "–ò—Å—Ö–æ–¥ -", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -", 
             "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +",
             "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -", 
             "–ò—Å—Ö–æ–¥ -", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -", 
             "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -",
             "–ò—Å—Ö–æ–¥ +", "–ò—Å—Ö–æ–¥ -")

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
contingency_table <- table(exposure, outcome)

# –í—ã–≤–æ–¥ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
print(contingency_table)


```

–ù–∞ —Ç–∞–∫–æ–π –¥–∏–∑–∞–π–Ω –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω —Ç–µ—Å—Ç –§–∏—à–µ—Ä–∞


### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–∞–±–ª–∏—Ü —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏

1. –û–±–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω—ã (–ø–æ–ø–µ—Ä–µ—á–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ)
–ü—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∏—Ö n –∏–º–µ–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Chi squared –∏ —Ç–µ—Å—Ç –°hi squared –±—ã–ª 
—Å–æ–∑–¥–∞–Ω –¥–ª—è —Ç–∞–∫–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞


2. –û–±–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω—ã (–∫–æ–≥–æ—Ä—Ç–∞ –∏–ª–∏ —Å–ª—É—á–∞–π –∫–æ–Ω—Ç—Ä–æ–ª—å)
Chi squared —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ!!!


3. –û–±–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–µ—Å–ª—É—á–∞–π–Ω—ã (—ç–∫–∑–æ—Ç–∏–∫–∞)
–¢–µ—Å—Ç –§–∏—à–µ—Ä–∞ –±—ã–ª —Å–æ–∑–¥–∞–Ω –¥–ª—è —Ç–∞–∫–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞, –Ω–æ –º–æ–∂–Ω–æ –∏ –Ω–∞ –∫–æ–≥–æ—Ä—Ç–Ω–æ–º –∏–ª–∏ —Å–ª—É—á–∞–π –∫–æ–Ω—Ç—Ä–æ–ª—å. –ü—Ä–∏ —ç—Ç–æ–º –æ–Ω —Ç–µ—Ä—è–µ—Ç –º–æ—â–Ω–æ—Å—Ç—å (–±–æ–ª–µ–µ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π). –ü—Ä–∏ –≤—ã–±–æ—Ä–∫–µ 30, 40, 50 —Ä–∞–∑–Ω–∏—Ü–∞ –≤ p-value –º–µ–∂–¥—É 2 —Ç–µ—Å—Ç–∞–º–∏ –∏—Å—á–µ–∑–∞–µ—Ç

–ü–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ —á—Ç–æ –≤—ã–±–æ—Ä–∫–∞ –Ω–µ–±–æ–ª—å—à–∞—è

–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ç–µ—Å—Ç–∞ Chi squared –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ —Å –º–∞–ª—ã–º–∏ —á–∏—Å–ª–∞–º–∏ –≤
—è—á–µ–π–∫–∞—Ö (bootstrap). –ê —á—Ç–æ —Å –ú–æ–Ω—Ç–µ –ö–∞—Ä–ª–æ?

?chisq.test()


```{r}

# x <- matrix(c(12, 7, 7, 0), ncol = 3)
# chisq.test(x)$p.value           
# chisq.test(x, simulate.p.value = TRUE, B = 10000)$p.value


x <- matrix(c(103, 81, 69, 18,
              339, 548, 220, 36,
              9, 19,5, 0), ncol = 3)
chisq.test(x)   

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç
chi_square_test <- chisq.test(x)

# –ò–∑–≤–ª–µ–∫–∏—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏
std_residuals <- as.table(chi_square_test$residuals)

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ—Ä–µ–π–º –¥–∞–Ω–Ω—ã—Ö
residual_data <- as.data.frame(as.table(std_residuals))
residual_data$Row <- rownames(residual_data)

# –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫
ggplot(residual_data, aes(x = Row, y = Freq)) +
  geom_bar(stat = "identity", position = "dodge", fill = "skyblue") +
  labs(title = "–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º",
       x = "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏",
       y = "–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏") +
  theme_minimal()


```

### –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –¥–ª—è —Ç–∞–±–ª–∏—Ü —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏ (–¢–µ—Å—Ç –ú–∞–∫-–ù–µ–º–∞—Ä–∞)
H0: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏—è –¥–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è —Ä–∞–≤–Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏—è –ø–æ—Å–ª–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è

–ü–æ—Ö–æ–∂ –Ω–∞ Chi squared !!!

```{r}

# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –¥–≤—É–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–¥–æ –∏ –ø–æ—Å–ª–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è)

my_matrix <- matrix(c(100, 10, 5, 100), nrow = 2, ncol = 2, dimnames = list(c("–†–∏–Ω–∏—Ç +", "–†–∏–Ω–∏—Ç -"), c("–†–∏–Ω–∏—Ç +", "–†–∏–Ω–∏—Ç -")))

# –í—ã–≤–æ–¥ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
print(my_matrix)

# Chi squared test
print(chisq.test(my_matrix, simulate.p.value = TRUE, B = 10000))

# McNemar's test
print(mcnemar.test(my_matrix))



```

========================================================================

# –ö—Ä–∏—Ç–µ—Ä–∏–∏ - –ª—é–±–æ–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ 

1. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ (—Ä–∞—Å—á—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è)
–í—ã–±–æ—Ä–∫–∞ –ø—Ä–∏—à–ª–∞ –∏–∑ —Ç–∞–∫–æ–≥–æ-—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è —Ä–∞—Å—á—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è


2. –ö—Ä–∏—Ç–µ—Ä–∏–∏ —Å–æ–≥–ª–∞—Å–∏—è (–≥–∏–ø–æ—Ç–µ–∑–∞ –æ –≤–∏–¥–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è)

3. –ù–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ (–Ω–µ –≤–∞–∂–Ω–æ –∏–∑ –∫–∞–∫–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è). –ù–µ –∑–∞–≤—è–∑–∞–Ω—ã –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–ª–µ–Ω–∏–µ (—Ä–∞–±–æ—Ç–∞–µ–º —Å —Ä–∞–Ω–≥–∞–º–∏)

4. Bootstrap - –º–æ–∂–Ω–æ –∏ –±–µ–∑ —Ñ–æ—Ä–º—É–ª. –î–∞–Ω–Ω—ã–µ —Ä–∞–∑–Ω–æ—à–æ—Ä—Å—Ç–Ω—ã–µ

5. Permutation ????


========================================================================

## –ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏


1. –ê—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏–µ, –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–ª–µ–Ω–∏—è, –Ω–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∞–Ω–æ–º–∞–ª–∏–π –∏ –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π

2. –¢–æ—á–Ω—ã–µ, –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –æ—Ç–∫—É–¥–∞ –ø—Ä–∏—à–ª–∞ –≤—ã–±–æ—Ä–∫–∞

–ù–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π –∏ –≤—ã–±–æ—Ä–∫–∞ –±–æ–ª—å—à–∞—è - –ø–µ—Ä–≤—ã–π  –≤–∞—Ä–∏–∞–Ω—Ç
–ï—Å–ª–∏ –µ—Å—Ç—å –∏ –∏–ª–∏ –≤—ã–±–æ—Ä–∫–∞ –º–∞–ª–µ–Ω—å–∫–∞—è –Ω–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π - –≤—Ç–æ—Ä–æ–π


========================================================================

### –î–æ–ª–∏

#### 1. Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è –¥–æ–ª–∏ (–∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏–π)

X1, ..., Xn ~ iid Bern(p)

H0: p = p0
H1: p!= p0 # –º–æ–∂–µ—Ç –±—ã—Ç—å < –∏–ª–∏ >

–ø–æ –¶–ü–¢

```{r}

p  <- 0.3 
p0 <- 0.5
n  <- 300

z = p-p0/sqrt(p0*(1-p0)/n)

print(z)



```

#### 2. Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –¥–æ–ª–µ–π (–∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏–π)

X1, ..., Xn ~ iid Bern(p)
Y1, ..., Yn ~ iid Bern(p)

H0: px  = py
H1: px != py  # –º–æ–∂–µ—Ç –±—ã—Ç—å < –∏–ª–∏ >

–ø–æ –¶–ü–¢ 


```{r}

px  <- 0.5 
py  <- 0.6
nx  <- 100
ny  <- 100

p <- (px*100+py*100)/(nx+ny)

z <- (px-py)/sqrt(p*(1-p)*(1/nx + 1/ny))

print(z)

sqrt(0.55*0.45*0.02)

```

#### 3. Z-–∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏–º—ã—Ö –¥–æ–ª–µ–π (–∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏–π)

X1, ..., Xn ~ iid Bern(p)
Y1, ..., Yn ~ iid Bern(p)

H0: px  = py
H1: px != py  # –º–æ–∂–µ—Ç –±—ã—Ç—å < –∏–ª–∏ >



```{r}


b <- 10
c <- 20
n <- 100

z <- (c-b)/sqrt(c+b-(((c-b)**2)/n))
 
print(z)

```


### –°—Ä–µ–¥–Ω–∏–µ


1. Z-–∫—Ä–∏—Ç–µ—Ä–∏–π

X1, ..., Xn ~ iid (m, sd**2)
H0: m  = m0
H0: m != m0

```{r}

m  <- 70
m0 <- 65
sd <- 20
n  <- 100

t <- (m0-m)/sqrt(sd**2/n)

print(t)

```

===============================================================

# –ù–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π –æ –≤–∏–¥–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

## –ö—Ä–∏—Ç–µ—Ä–∏–π –∑–Ω–∞–∫–æ–≤
–í—ã–±–æ—Ä–∫—É –ø—Ä–µ–≤—Ä–∞—Ç–∏–º –≤ –Ω—É–ª–∏ –∏ –µ–¥–∏–Ω–∏—Ü—ã, –ø–æ—Ç–µ—Ä—è–≤ —á–∞—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–æ –º–æ–∂–µ–º –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º

### –û–¥–Ω–æ–≤—ã–±–æ—Ä–æ—á–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π –∑–Ω–∞–∫–æ–≤
H0: med(X) (—Ü–µ–Ω—Ç—Ä —Ä–∞—Å–ø—Ä–µ–ª–µ–Ω–∏—è)  = m0 
H1: med(X) (—Ü–µ–Ω—Ç—Ä —Ä–∞—Å–ø—Ä–µ–ª–µ–Ω–∏—è) != m0 


6, 4, 4, 7, 8 # –ø–æ–ø—É–≥–∞–∏

H0: med(X) (—Ü–µ–Ω—Ç—Ä —Ä–∞—Å–ø—Ä–µ–ª–µ–Ω–∏—è)  = 5 
H1: med(X) (—Ü–µ–Ω—Ç—Ä —Ä–∞—Å–ø—Ä–µ–ª–µ–Ω–∏—è)  > 5 

## –†–∞–Ω–≥–æ–≤—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏

# Bootstrap (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –î–ò –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π)

# –ö—Ä–∏—Ç–µ—Ä–∏–∏ —Å–æ–≥–ª–∞—Å–∏—è







=========================================================

# –ù–∞–ø–æ–º–Ω–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

## Bernoulii

Ber(p)

Ex: coin toss (0.5 for a fair coin)

```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
library(ggplot2)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ë–µ—Ä–Ω—É–ª–ª–∏
p <- 0.3  # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞

# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—Ä–µ–π–º–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∏ –∏—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏
data <- data.frame(–ò—Å—Ö–æ–¥ = c(0, 1), –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å = c(1 - p, p))

# –ì—Ä–∞—Ñ–∏–∫ "lollipop" –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ë–µ—Ä–Ω—É–ª–ª–∏
ggplot(data, aes(x = –ò—Å—Ö–æ–¥, y = 0, xend = –ò—Å—Ö–æ–¥, yend = –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)) +
  geom_segment(size = 1, color = "red") +
  geom_point(aes(x = –ò—Å—Ö–æ–¥, y = –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å), color = "red", size = 3) +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ë–µ—Ä–Ω—É–ª–ª–∏", x = "–ò—Å—Ö–æ–¥", y = "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å") +
  theme_minimal()


```


## Binomial distribution

Bin(N, p)

X1,..., Xn - i.i.d. Ber(p) Sum(i) Xi ~ Bin(N, p)

number of baskets made in N attemts


```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
library(ggplot2)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
n <- 20   # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø—ã—Ç–∞–Ω–∏–π
p <- 0.1 # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞ –≤ –∫–∞–∂–¥–æ–º –∏—Å–ø—ã—Ç–∞–Ω–∏–∏

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
binomial_data <- rbinom(10000, size = n, prob = p)

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π x –æ—Ç 0 –¥–æ 10 —Å —à–∞–≥–æ–º 1
x_values <- 0:n

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
ggplot(data.frame(binomial_data), aes(x = binomial_data)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7, aes(y = ..density..)) +
  scale_x_continuous(breaks = x_values) +  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–µ–ª–µ–Ω–∏–π –Ω–∞ –æ—Å–∏ x
  labs(title = "–ë–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ", x = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—Ö–æ–≤", y = "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å") +
  theme_minimal()


```

## Binomial distribution

Poiss(lambda)

number of raisins in a bun (–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑—é–º–∞ –≤ –±—É–ª–æ—á–∫–µ)


```{r}

# –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
library(ggplot2)

# –ó–∞–¥–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ü—É–∞—Å—Å–æ–Ω–∞
lambda <- 3  # –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ –∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ü—É–∞—Å—Å–æ–Ω–∞
sample_data <- rpois(1000, lambda)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ü—É–∞—Å—Å–æ–Ω–∞
ggplot(data.frame(sample_data), aes(x = sample_data)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ü—É–∞—Å—Å–æ–Ω–∞ (–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞)", x = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π", y = "–ü—Ä–æ—Ü–µ–Ω—Ç") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +  # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
  theme_minimal()



```



```{r}


# Bernoulli Distribution:
# 
# The Bernoulli distribution represents a single trial with two possible outcomes (usually labeled as 0 and 1) where '1' denotes success and '0' denotes failure. The probability mass function (PMF) of the Bernoulli distribution is as follows:
# 
# For x = 0: P(X = 0) = 1 - p
# For x = 1: P(X = 1) = p
# Where 'p' is the probability of success.
# 
# Binomial Distribution:
# 
# The binomial distribution models the number of successes (k) in a fixed number of independent Bernoulli trials (n) with the same probability of success (p) in each trial. The PMF of the binomial distribution is as follows:
# 
# P(X = k) = C(n, k) * p^k * (1 - p)^(n - k)
# 
# Where:
# 
# C(n, k) is the binomial coefficient, which is equal to n! / (k! * (n - k)!).
# 'p' is the probability of success in each trial.
# 'k' is the number of successes.
# 'n' is the number of trials.
# Poisson Distribution:
# 
# The Poisson distribution models the number of events occurring in a fixed interval of time or space. The PMF of the Poisson distribution is as follows:
# 
# P(X = k) = (Œª^k * e^(-Œª)) / k!
# 
# Where:
# 
# 'Œª' (lambda) is the average rate of events occurring in the interval.
# 'k' is the number of events that you want to find the probability for.
# 'e' is the base of the natural logarithm (approximately equal to 2.71828).
# These are the probability density functions for the Bernoulli, binomial, and Poisson distributions. You can use these formulas to calculate the probabilities for specific values of 'k' in each distribution.


```









# Normal means, one sample

Example: birth weight
Average birth weight in the USA is 3300 g, for women living in poverty is 2800 g
25 women living in poverty participated in new prenatal care program. Hospital 
records show that the average birth weight of their babies was 3075 g with a standard 
deviation of 500 g. Does the program work?


## Z test for a mean

sample:    Xn = (X1, ..., Xn), i.i.d. X~N(m, sigma squared), sigma is known

H0:        m = m0 (hypothesised mean)       

H1:        m <!=> m0

statistic: Z = (X - m)/(sigma/sqrt(n))

null distribution: N(0, 1)


## T test for a mean (for a large sample size value of T is close to Z)

sample:    Xn = (X1, ..., Xn), i.i.d. X~N(m, sigma squared), sigma is unknown

H0:        m = m0 (hypothesised mean)      m = 2800   

H1:        m <!=> m0                       m > 2800 

statistic: T = (X - m)/(s/sqrt(n))         3075-2800 / 500/sqrt(25) = 275/100 = 2.75 (p=0.0056)

null distribution: St(n-1)


verage birthweight significantly increases by 275 g (p=0.0056, t-test with one-sided alternative of the increase,
95% confidence interval [234, 316] g)


One side alternative should be used then the direction of change could be hypothesized in advance.
It is not OK to pick the side of the alternative after you have seen the data!!!



## Normal means, two samples

Example: part time working hours

In 1973, 134 of the respondents were worfing part-time, in 2018 - 255. For each of them we know 
the number of working hours in a week before the survey. Did the average number. Did the average number 
of working hours change?

samples:   X1 = (X11, ..., X1n1), i.i.d. X1~N(m, sigma squared),
           X2 = (X21, ..., X2n2), i.i.d. X2~N(m, sigma squared),
           samples are independent,
           sigma1 and sigma2 is unknown

H0:        m1 = m2 (hypothesised mean)       

H1:        m1 <!=> m2                       

statistic: T = (X1 - X2)/sqrt(s1/n1 + s2/n2)         

null distribution: St(v) (Welch t-test) is approximate, not exact!

There is no exact solution (Behrens-Fisher problem)
The approximation is very accurate when n1=n2 or [n1>n2]=[sigma1>sigma2]

Part time working hours increased significantly bz 2.6 hours (p=0.0276 for t-test two-sided alternative, 
95% CI for increase - [0.29, 4.95] hours)



## Normal means, two samples (dependent)

Example: ADHD treatment

24 children with ADHD had their performance measured on delay on gratification
(DOG) task 60 minutes taking Methylphenidate and on a different week, after taking placebo.
Does Methylphenidate work?


samples:   X1 = (X11, ..., X1n1), i.i.d. X1~N(m, sigma squared),
           X2 = (X21, ..., X2n2), i.i.d. X2~N(m, sigma squared),
           samples are paired,
           sigma1 and sigma2 is unknown

H0:        m1 = m2 (hypothesised mean)       

H1:        m1 <!=> m2                       

statistic: T = (X - m)/(s/sqrt(n))      , S-?   

null distribution: St(n-1) - SIMILAR AS ONE SAMPLE T-TEST ON PAIRWISE DIFFERENCE

For ADHD example: the average score of delay of grafication test taking Methylphenidate in significantly 
higher by 4.95 points (p=0.0038 for two-sided alternative, 95% CI for the increase - [1.78, 8.14] points)


# Goodness of fit tests (–¢–µ—Å—Ç—ã –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è))

Is X ~ F (does my sample come from distribution F)
Probably not, very few data generating processes follow a distribution exactly 
Is it sensible to approximate my population with Fx

## Pearson's chi squared test

samples:   X = (X1, ..., Xn)

H0:        X~F(x)     

H1:        X!~F(x)                      

statistic: chi=sum(1, K)(Oi-npi)**2/npi

null distribution: X**2 K-p, p - number of fitted parameters




```{r}

install.packages('pwr')

# Load necessary libraries
library(ggplot2)
library(pwr)

# Create a sequence of proportions (prop) from 0.01 to 0.99 with a step of 0.01
prop <- seq(0.01, 0.99, by = 0.01)

# Calculate the sample sizes (n) for a 95% confidence interval for each proportion
n <- sapply(prop, function(p) ceiling(pwr::pwr.p.test(h = p, sig.level = 0.05, power = 0.8)))

# Create a data frame to store prop and n
data <- data.frame(prop, n)

# Create the plot
ggplot(data, aes(x = prop, y = n)) +
  geom_line(color = "blue") +
  labs(title = "Sample Size for Confidence Intervals of Proportions",
       x = "Proportion (p)",
       y = "Sample Size (n)") +
  theme_minimal()



```
























